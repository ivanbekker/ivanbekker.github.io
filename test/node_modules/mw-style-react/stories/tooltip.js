import PropTypes from 'prop-types';
import React, {PureComponent} from 'react';
import {storiesOf} from '@storybook/react';
import {text} from '@storybook/addon-knobs/react';
import Icon from '../src/components/Icon/Icon.js';
import Label from '../src/components/Label/Label.js';
import Button from '../src/components/Button/Button.js';
import Chip from '../src/components/Chip/Chip.js';
import Tooltip from '../src/components/Tooltip';
import infoDecorator from '../.storybook/customDecorators/infoDecorator';
import themeDecorator from '../.storybook/customDecorators/themeDecorator';

const stories = storiesOf('Tooltip', module);
infoDecorator(stories);
themeDecorator(stories);

class TooltipExample extends PureComponent {

  constructor(props) {
    super(props);
    this.state = {
      show: false
    };
  }

  click() {
    this.setState({show: !this.state.show});
    Tooltip.rebuild();
  }

  renderTest() {
    if (!this.state.show) return;
    const {value4} = this.props;
    return (
      <div style={{marginRight: 10}}>
        <Tooltip value={value4}>
          <Button
            label="Test"
            icon="plus"
            tip={'Dynamic tooltip'}
          />
        </Tooltip>
      </div>
    );
  }

  render() {
    const {id, value, value2, value3} = this.props;
    return (
      <div style={{display: 'flex'}}>
        <div style={{marginRight: 10}}>
          <Tooltip value={value}>
            <Icon
              id={id}
              ref="test"
              type="search"
            />
          </Tooltip>
        </div>
        <div style={{marginRight: 10}}>
          <Tooltip value={value2}>
            <Label
              value="label value"
              tip={value2}
            />
          </Tooltip>
        </div>
        <div style={{marginRight: 10, position: 'relative'}}>
          <Tooltip value={value3}>
            <Button
              label="Button"
              icon="search"
              tip={value3}
              onClick={::this.click}
            />
          </Tooltip>
          <Tooltip value={value3}>
            <Button
              label="Button"
              icon="search"
              tip={value3}
              onClick={::this.click}
            />
          </Tooltip>
          <Tooltip value={value3}>
            <Chip
              label={value3}
            />
          </Tooltip>
        </div>
        <Tooltip value={'settings'}>
          <Icon styleName="header__controls__btn" type={'settings'}/>
        </Tooltip>
        <Tooltip value={'notification'}>
          <Icon styleName="header__controls__btn" type={'notification'}/>
        </Tooltip>
        {this.renderTest()}
      </div>
    );
  }
}

TooltipExample.propTypes = {
  value: PropTypes.string,
  value2: PropTypes.string,
  value3: PropTypes.string,
  value4: PropTypes.string,
  id: PropTypes.string
};

stories
  .add('default',
    () => (
      <TooltipExample
        value={text('Text', 'icon')}
        value2={text('Text2', 'label')}
        value3={text('Text3', 'button')}
        value4={text('Text4', 'button test')}
      />
    )
  );
